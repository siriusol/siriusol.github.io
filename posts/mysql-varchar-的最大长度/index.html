<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <title>MySQL varchar 的最大长度 - Ther 的博客</title><meta name="author" content="">
<meta name="author-link" content="">
<meta name="description" content="备注：全文示例皆在 8.0.17 版本下进行。
在MySQL官方定义中，常用的 COMPACT、DYNAMIC行模式下，varchar 的最大长度并不是固定数值，取决于以下限制：
行长度限制； 编码长度限制； 存储限制。 行长度限制 MySQL 要求一行的定义长度不能超过 65535 字节（约 64 KB）。若定义长度超过这个值，则提示：
1118 - Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. This includes storage overhead, check the manual. You have to change some columns to TEXT or BLOBs 编码长度限制 每个字符的实际占据的空间与字符所使用的字符集相关。下表列举的一些例子：
字符集 每个字符占用存储空间（单位：字节） latin1 1 GBK 2 UTF8 3 UTF8MB4 4 存储限制 根据限制 1，每行最多能存储 65535 字节的数据，这包括：" />
<meta name="keywords" content="MySQL" /><meta itemprop="name" content="MySQL varchar 的最大长度">
<meta itemprop="description" content="备注：全文示例皆在 8.0.17 版本下进行。
在MySQL官方定义中，常用的 COMPACT、DYNAMIC行模式下，varchar 的最大长度并不是固定数值，取决于以下限制：
行长度限制； 编码长度限制； 存储限制。 行长度限制 MySQL 要求一行的定义长度不能超过 65535 字节（约 64 KB）。若定义长度超过这个值，则提示：
1118 - Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. This includes storage overhead, check the manual. You have to change some columns to TEXT or BLOBs 编码长度限制 每个字符的实际占据的空间与字符所使用的字符集相关。下表列举的一些例子：
字符集 每个字符占用存储空间（单位：字节） latin1 1 GBK 2 UTF8 3 UTF8MB4 4 存储限制 根据限制 1，每行最多能存储 65535 字节的数据，这包括："><meta itemprop="datePublished" content="2022-02-03T19:17:31+08:00" />
<meta itemprop="dateModified" content="2022-02-03T19:17:31+08:00" />
<meta itemprop="wordCount" content="145">
<meta itemprop="keywords" content="MySQL," /><meta property="og:title" content="MySQL varchar 的最大长度" />
<meta property="og:description" content="备注：全文示例皆在 8.0.17 版本下进行。
在MySQL官方定义中，常用的 COMPACT、DYNAMIC行模式下，varchar 的最大长度并不是固定数值，取决于以下限制：
行长度限制； 编码长度限制； 存储限制。 行长度限制 MySQL 要求一行的定义长度不能超过 65535 字节（约 64 KB）。若定义长度超过这个值，则提示：
1118 - Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. This includes storage overhead, check the manual. You have to change some columns to TEXT or BLOBs 编码长度限制 每个字符的实际占据的空间与字符所使用的字符集相关。下表列举的一些例子：
字符集 每个字符占用存储空间（单位：字节） latin1 1 GBK 2 UTF8 3 UTF8MB4 4 存储限制 根据限制 1，每行最多能存储 65535 字节的数据，这包括：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.ther.cool/posts/mysql-varchar-%E7%9A%84%E6%9C%80%E5%A4%A7%E9%95%BF%E5%BA%A6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-03T19:17:31+08:00" />
<meta property="article:modified_time" content="2022-02-03T19:17:31+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MySQL varchar 的最大长度"/>
<meta name="twitter:description" content="备注：全文示例皆在 8.0.17 版本下进行。
在MySQL官方定义中，常用的 COMPACT、DYNAMIC行模式下，varchar 的最大长度并不是固定数值，取决于以下限制：
行长度限制； 编码长度限制； 存储限制。 行长度限制 MySQL 要求一行的定义长度不能超过 65535 字节（约 64 KB）。若定义长度超过这个值，则提示：
1118 - Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. This includes storage overhead, check the manual. You have to change some columns to TEXT or BLOBs 编码长度限制 每个字符的实际占据的空间与字符所使用的字符集相关。下表列举的一些例子：
字符集 每个字符占用存储空间（单位：字节） latin1 1 GBK 2 UTF8 3 UTF8MB4 4 存储限制 根据限制 1，每行最多能存储 65535 字节的数据，这包括："/>
<meta name="application-name" content="Ther 的博客">
<meta name="apple-mobile-web-app-title" content="Ther 的博客"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="canonical" href="https://blog.ther.cool/posts/mysql-varchar-%E7%9A%84%E6%9C%80%E5%A4%A7%E9%95%BF%E5%BA%A6/" /><link rel="prev" href="https://blog.ther.cool/posts/%E6%B5%8B%E8%AF%95/" /><link rel="next" href="https://blog.ther.cool/posts/%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "MySQL varchar 的最大长度",
    "inLanguage": "en-us",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/blog.ther.cool\/posts\/mysql-varchar-%E7%9A%84%E6%9C%80%E5%A4%A7%E9%95%BF%E5%BA%A6\/"
    },"genre": "posts","keywords": "MySQL","wordcount":  145 ,
    "url": "https:\/\/blog.ther.cool\/posts\/mysql-varchar-%E7%9A%84%E6%9C%80%E5%A4%A7%E9%95%BF%E5%BA%A6\/","datePublished": "2022-02-03T19:17:31+08:00","dateModified": "2022-02-03T19:17:31+08:00","publisher": {
      "@type": "Organization",
      "name": "Author"},"author": {
        "@type": "Person",
        "name": "Author"
      },"description": ""
  }
  </script></head>
  <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script><div class="wrapper"><header class="desktop" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Ther 的博客"><span class="header-title-text">Ther 的博客</span></a></div>
    <nav>
      <ul class="menu"><li
              class="menu-item"
              
            >
              <a
                class="menu-link"
                href="/posts/"
                
                
              >文章</a></li><li
              class="menu-item"
              
            >
              <a
                class="menu-link"
                href="/categories/"
                
                
              >分类</a></li><li
              class="menu-item"
              
            >
              <a
                class="menu-link"
                href="/tags/"
                
                
              >标签</a></li><li
              class="menu-item"
              
            >
              <a
                class="menu-link"
                href="/about/"
                
                
              >关于</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw"></i>
        </li>
      </ul>
    </nav>
  </div>
</header><header class="mobile" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Ther 的博客"><span class="header-title-text">Ther 的博客</span></a></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                class="menu-link"
                href="/posts/"
                
                
              >文章</a></li><li
              class="menu-item"
            ><a
                class="menu-link"
                href="/categories/"
                
                
              >分类</a></li><li
              class="menu-item"
            ><a
                class="menu-link"
                href="/tags/"
                
                
              >标签</a></li><li
              class="menu-item"
            ><a
                class="menu-link"
                href="/about/"
                
                
              >关于</a></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw"></i>
        </li></ul>
    </nav>
  </div>
</header>
<div class="search-dropdown desktop">
  <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
  <div id="search-dropdown-mobile"></div>
</div>
<main class="container" page-style="normal"><aside class="toc" id="toc-auto"><h2 class="toc-title">Contents <i class="toc-icon fa-solid fa-angle-down fa-fw"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside>

  <aside class="aside-custom">
    
  </aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX">MySQL varchar 的最大长度</h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle"></i>
      </span></span>
          <span class="post-category">included in <a href="/categories/mysql/"><i class="fa-regular fa-folder fa-fw"></i>&nbsp;MySQL</a></span></div>
      <div class="post-meta-line"><span title=2022-02-03&#32;19:17:31>
            <i class="fa-regular fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-02-03" >2022-02-03</time>
          </span>&nbsp;<i class="fa-solid fa-pencil-alt fa-fw"></i>&nbsp;145 words&nbsp;
        <i class="fa-regular fa-clock fa-fw"></i>&nbsp;One minute&nbsp;</div>
    </div><div class="details toc" id="toc-static" kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#行长度限制">行长度限制</a></li>
    <li><a href="#编码长度限制">编码长度限制</a></li>
    <li><a href="#存储限制">存储限制</a></li>
    <li><a href="#长度计算">长度计算</a></li>
  </ul>
</nav></div>
      </div><div
      class="content"
      id="content"
      
      
    ><p><strong>备注</strong>：全文示例皆在 8.0.17 版本下进行。</p>
<hr>
<p>在MySQL官方定义中，常用的 <code>COMPACT</code>、<code>DYNAMIC</code>行模式下，varchar 的最大长度并不是固定数值，取决于以下限制：</p>
<ol>
<li>行长度限制；</li>
<li>编码长度限制；</li>
<li>存储限制。</li>
</ol>
<h2 id="行长度限制">行长度限制</h2>
<p>MySQL 要求一行的定义长度不能超过 65535 字节（约 64 KB）。若定义长度超过这个值，则提示：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="mi">1118</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Row</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">too</span><span class="w"> </span><span class="n">large</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">counting</span><span class="w"> </span><span class="n">BLOBs</span><span class="p">,</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mi">65535</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">includes</span><span class="w"> </span><span class="n">storage</span><span class="w"> </span><span class="n">overhead</span><span class="p">,</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">manual</span><span class="p">.</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">change</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">columns</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="kt">TEXT</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">BLOBs</span><span class="w">
</span></span></span></code></pre></div><h2 id="编码长度限制">编码长度限制</h2>
<p>每个字符的实际占据的空间与字符所使用的字符集相关。下表列举的一些例子：</p>
<table>
<thead>
<tr>
<th>字符集</th>
<th>每个字符占用存储空间（单位：字节）</th>
</tr>
</thead>
<tbody>
<tr>
<td>latin1</td>
<td>1</td>
</tr>
<tr>
<td>GBK</td>
<td>2</td>
</tr>
<tr>
<td>UTF8</td>
<td>3</td>
</tr>
<tr>
<td>UTF8MB4</td>
<td>4</td>
</tr>
</tbody>
</table>
<!-- raw HTML omitted -->
<h2 id="存储限制">存储限制</h2>
<p>根据限制 1，每行最多能存储 65535 字节的数据，这包括：</p>
<ol>
<li>所有字段的长度；</li>
<li>每个变长字段的长度，当存储的长度小于 255 字节时，需要 1 字节记录，大于 255 字节时，需要 2 字节；</li>
<li>NULL 标识位的累计长度。</li>
</ol>
<p>其中，NULL 标记位用于表示某个字段是否允许为 NULL。每个字段使用 1 个 bit 位来表示。每 8 个标记组成一个字段。若一行中有 N 个字段，则一行中用于 NULL 标记位所消耗的空间计算公式为：</p>
<!-- raw HTML omitted -->
<p>或者这样表示：⌈ N / 8 ⌉ （向上取整）。</p>
<h2 id="长度计算">长度计算</h2>
<p><strong>最大长度(字符数) = （<code>行存储最大字节数</code> - <code>NULL标识列占用字节数</code> - <code>长度标识字节数</code>） / <code>字符集单字符最大字节数</code></strong>。有余数时向下取整。</p>
<p>长度标识位表示的是字节数。大于 255 后使用两字节，是因为按照可能的数据大小，分为 0~255(2^8)、256~65535(2^16)，分别对应 1 字节和 2 字节。</p>
<p>根据字段声明的字符长度，计算可能的字节数，再决定长度标志的字节数。如 VARCHAR(100)，字符集为 UTF8，可能的字节数为 300，则长度标识为 2 字节。</p>
<p>长度标志位只是存储开销，不影响长度约束。长度约束的是数据的字符数，允许的最大字符数与字符集有关。</p>
<p>如列指定字符集为 UTF8、每个字符最大可占用 3 个字节，行最大长度为 65535 字节，那么该列可设置的最大列大小为65535 ÷ 3 ≈ 21844（向下取整）。</p>
<p>同理如果是 UTF8MB4，单字符最大占 4 个字节，可设置最大列大小为 65535 ÷ 4 ≈ 16383（向下取整）。</p>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title=2022-02-03&#32;19:17:31>Updated on 2022-02-03</span>
      </div>
      <div class="post-info-license "></div>
    </div>
    <div class="post-info-line">
      <div class="post-info-md"></div>
      <div class="post-info-share">
        <span></span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw"></i>&nbsp;<a href="/tags/mysql/">MySQL</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/%E6%B5%8B%E8%AF%95/" class="prev" rel="prev" title="测试文档"><i class="fa-solid fa-angle-left fa-fw"></i>测试文档</a>
      <a href="/posts/%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/" class="next" rel="next" title="评论系统架构设计">评论系统架构设计<i class="fa-solid fa-angle-right fa-fw"></i></a></div>
</div>
</article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer" title="Hugo 0.101.0">Hugo</a> | Theme - <a href="https://github.com/Lruihao/FixIt" target="_blank" rel="external nofollow noopener noreffer" title="FixIt v0.2.15-RC"><img class="fixit-icon" src="/images/fixit.svg" alt="FixIt logo" />&nbsp;FixIt</a>
        </div></div>
  </footer></div><div class="widgets">
  <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
      <i class="fa-solid fa-arrow-up fa-fw"></i>
    </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
      <i class="fa-solid fa-comment fa-fw"></i>
    </a>
  </div><div id="mask"></div>
</div><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js" async defer></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","editLockTitle":"Lock editable code block","editUnLockTitle":"Unlock editable code block","editable":true,"maxShownLines":10},"comment":{},"enablePWA":null};</script><script type="text/javascript" src="/js/theme.min.js" defer></script></body>
</html>
